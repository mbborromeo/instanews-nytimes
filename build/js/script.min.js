document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("stories"),t=document.getElementById("category"),n=document.getElementsByTagName("header")[0],a=document.createElement("img");function i(t,n){const a=document.createElement("ul");for(let e=0;e<n;e++){const n=document.createElement("li"),i=document.createElement("a");i.setAttribute("target","_blank"),i.setAttribute("href",t[e].url);const l=document.createElement("figure"),r=document.createElement("img");r.setAttribute("src",t[e].multimedia[0].url);const o=document.createElement("figcaption");o.innerText=t[e].abstract,l.append(r),l.append(o),i.append(l),n.append(i),a.append(n)}e.append(a)}a.setAttribute("id","loader"),a.setAttribute("src","images/ajax-loader.gif"),a.setAttribute("style","display:none"),e.append(a),t.addEventListener("change",(function(e){const t=this.value;if(n.setAttribute("class","shrink"),a.setAttribute("style","display:block"),document.querySelector("ul")){let e=document.querySelector("ul");e.setAttribute("display","none"),e.parentNode.removeChild(e)}$.ajax({method:"GET",url:`https://api.nytimes.com/svc/topstories/v2/${t}.json?api-key=BvCBQeH2bfwoKZ8Uabwe0ynMvv1yx8VZ`}).done((function(e){if(e.results.length>0){const t=e.results.filter(e=>e.multimedia&&e.multimedia.length&&e.multimedia[0].url);a.setAttribute("style","display:none"),t.length>12?i(t,12):i(t,t.length)}})).fail((function(){alert("error with API call")}))}))}));