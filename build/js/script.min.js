document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("stories"),t=document.getElementById("category"),n=document.getElementsByTagName("header")[0],a=document.getElementById("loader");function s(){e.classList.remove("loading"),a.setAttribute("style","display:none")}function o(t){const n=document.createElement("ul");t.forEach((e,t)=>{const a=document.createElement("li"),o=document.createElement("a");o.setAttribute("href",e.url),o.setAttribute("target","_blank");const l=document.createElement("figure"),i=document.createElement("img");i.setAttribute("alt","Image "+t),i.setAttribute("src",e.multimedia[0].url),i.onload=function(){this.setAttribute("data-loaded","true"),function(){const e=document.getElementsByTagName("ul")[0];if(function(e){let t=!0;const n=e.getElementsByTagName("img");for(let e=0;e<n.length;e++)if(!0!==n[e].hasAttribute("data-loaded"))return t=!1,!1;return t}(e)){s(),e.classList.add("show");const t=e.getElementsByTagName("li");for(let e=0;e<t.length;e++)setTimeout((function(){t[e].classList.add("show")}),150*e)}}()};const d=document.createElement("figcaption"),r=document.createElement("h2");r.innerText=e.title;const c=document.createElement("p");c.innerText=e.abstract,d.append(r),d.append(c),l.append(i),l.append(d),o.append(l),a.append(o),n.append(a)}),e.append(n)}t.addEventListener("change",(function(t){const l=this.value;n.classList.add("shrink"),e.classList.add("expand");let i=document.querySelector("ul");null!==i&&i.parentNode.removeChild(i),e.classList.add("loading"),a.setAttribute("style","display:flex"),$.ajax({method:"GET",url:`https://api.nytimes.com/svc/topstories/v2/${l}.json?api-key=BvCBQeH2bfwoKZ8Uabwe0ynMvv1yx8VZ`}).done((function(t){if("OK"===t.status&&t.results&&t.results.length>0){o(t.results.filter(e=>e.multimedia&&e.multimedia.length&&e.multimedia[0].url).slice(0,12))}else s(),e.innerText="No articles returned for category "+l})).fail((function(){s(),e.innerText="Error - failed to load articles for category "+l}))}))}));