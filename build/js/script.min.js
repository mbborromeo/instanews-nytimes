document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("stories"),t=document.getElementById("category"),n=document.getElementsByTagName("header")[0],r=document.getElementById("loader");function a(){r.setAttribute("style","display:none")}t.addEventListener("change",(function(t){const l=this.value;n.setAttribute("class","shrink"),e.setAttribute("class","expand");let o=document.querySelector("ul");null!==o&&o.parentNode.removeChild(o),r.setAttribute("style","display:flex"),$.ajax({method:"GET",url:`https://api.nytimes.com/svc/topstories/v2/${l}.json?api-key=BvCBQeH2bfwoKZ8Uabwe0ynMvv1yx8VZ`}).done((function(t){if(console.log(t),"OK"===t.status&&t.results&&t.results.length>0){!function(t){const n=document.createElement("ul");t.forEach((e,t)=>{const r=document.createElement("li"),a=document.createElement("a");a.setAttribute("href",e.url),a.setAttribute("target","_blank");const l=document.createElement("figure"),o=document.createElement("img");o.setAttribute("src",e.multimedia[0].url),o.setAttribute("alt","Image "+t);const c=document.createElement("figcaption"),i=document.createElement("h2");i.innerText=e.title;const s=document.createElement("p");s.innerText=e.abstract,c.append(i),c.append(s),l.append(o),l.append(c),a.append(l),r.append(a),n.append(r)}),a(),e.append(n)}(t.results.filter(e=>e.multimedia&&e.multimedia.length&&e.multimedia[0].url).slice(0,12))}else a(),e.innerText="No articles returned for category "+l})).fail((function(){alert("error with API call"),a(),e.innerText="Error - failed to load articles for category "+l}))}))}));